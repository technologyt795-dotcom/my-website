<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ù„ÙˆØ­Ø© Ø§Ù„Ù…ÙŠØ²Ø§Ù†ÙŠØ© Ø§Ù„Ù…ØªÙ‚Ø¯Ù…Ø© - Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„ÙØ§ØªØ­</title>
<link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700&family=Tajawal:wght@400;700&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
<style>
/* ===== Ø¹Ø§Ù… ===== */
body { font-family: 'Cairo','Tajawal',sans-serif; margin:0; background-color:#f5f5f5; color:#000; }
.container { display:flex; flex-wrap:wrap; min-height:100vh; }
.sidebar { width:220px; background-color:#e0e0e0; padding:20px; box-shadow:2px 0 5px rgba(0,0,0,0.1); flex-shrink:0; }
.sidebar .logo { font-size:1.5em; margin-bottom:30px; text-align:center; }
.sidebar ul { list-style:none; padding:0; margin:0; display:flex; flex-direction:column; gap:10px; }
.sidebar ul li { padding:12px; cursor:pointer; border-radius:8px; display:flex; align-items:center; gap:10px; transition:background 0.3s; }
.sidebar ul li.active, .sidebar ul li:hover { background-color:#90caf9; }
.main-content { flex:1; padding:20px; min-width:0; overflow-x:hidden; }
.section { display:none; animation:fadeIn 0.3s ease-in-out; }
.section.active { display:block; }
.cards { display:flex; gap:20px; flex-wrap:wrap; margin-bottom:20px; }
.card { flex:1 1 180px; min-width:150px; background:rgba(255,255,255,0.9); padding:20px; border-radius:15px; box-shadow:0 2px 8px rgba(0,0,0,0.1); text-align:center; }
.card h3 { margin:0 0 10px; font-size:1.1em; }
.card p { font-size:1.2em; font-weight:bold; margin:0; }
.income-card { border-top:4px solid #2e7d32; }
.expenses-card { border-top:4px solid #c62828; }
.balance-card { border-top:4px solid #0288d1; }
.savings-card { border-top:4px solid #fbc02d; }
.available-card { border-top:4px solid #ff9800; }
.chart { background:rgba(255,255,255,0.9); padding:20px; border-radius:15px; box-shadow:0 2px 8px rgba(0,0,0,0.1); margin-top:20px; overflow-x:auto; }
.form-group { display:flex; gap:10px; margin-bottom:10px; flex-wrap:wrap; }
.form-group input, select, button { padding:8px; border-radius:5px; border:1px solid #ccc; flex:1; min-width:100px; }
button { background-color:#1976d2; color:#fff; border:none; cursor:pointer; transition:0.3s; }
button:hover { background-color:#0d47a1; }
table { width:100%; border-collapse:collapse; margin-top:10px; background:#fff; color:#000; }
th, td { padding:8px; border:1px solid #ccc; text-align:center; font-size:0.9em; }
th { background-color:#f2f2f2; }
@media (max-width: 992px) {
.container { flex-direction:column; }
.sidebar { width:100%; display:flex; overflow-x:auto; padding:10px 0; box-shadow:none; }
.sidebar ul { flex-direction:row; gap:5px; padding-left:10px; }
.sidebar ul li { flex:1 0 auto; justify-content:center; text-align:center; margin-bottom:0; }
.cards { flex-direction:column; }
.form-group { flex-direction:column; }
.form-group input, select, button { width:100%; }
.chart canvas { width:100% !important; height:auto !important; }
table { font-size:0.8em; }
}
@media (max-width: 576px) {
.cards { gap:10px; }
.card { padding:15px; font-size:0.9em; }
.chart { padding:15px; }
.form-group input, select, button { font-size:0.9em; }
table th, table td { padding:6px; }
}
</style>
</head>
<body>
<div class="container">

<aside class="sidebar">
<h2 class="logo">ğŸ’° Ø§Ù„Ù…ÙŠØ²Ø§Ù†ÙŠØ©</h2>
<nav>
<ul>
<li class="active" data-section="dashboard"><i class="fas fa-chart-line"></i> Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…</li>
<li data-section="income"><i class="fas fa-wallet"></i> Ø§Ù„Ø¯Ø®Ù„</li>
<li data-section="expenses"><i class="fas fa-money-bill-wave"></i> Ø§Ù„Ù…ØµØ±ÙˆÙØ§Øª</li>
<li data-section="liabilities"><i class="fas fa-file-invoice"></i> Ø§Ù„Ø§Ù„ØªØ²Ø§Ù…Ø§Øª</li>
<li data-section="months"><i class="fas fa-calendar-alt"></i> Ø§Ù„Ø£Ø´Ù‡Ø±</li>
<li data-section="reports"><i class="fas fa-chart-pie"></i> Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ±</li>
<li data-section="settings"><i class="fas fa-cog"></i> Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª</li>
</ul>
</nav>
</aside>

<main class="main-content">

<section id="dashboard" class="section active">
<h1>Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…</h1>
<div class="cards">
<div class="card income-card"><h3>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø¯Ø®Ù„</h3><p>0 Ø±ÙŠØ§Ù„</p></div>
<div class="card expenses-card"><h3>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…ØµØ±ÙˆÙØ§Øª</h3><p>0 Ø±ÙŠØ§Ù„</p></div>
<div class="card balance-card"><h3>ØµØ§ÙÙŠ Ø§Ù„Ø±ØµÙŠØ¯</h3><p>0 Ø±ÙŠØ§Ù„</p></div>
<div class="card savings-card"><h3>Ø§Ù„Ø§Ø¯Ø®Ø§Ø±</h3><p>0 Ø±ÙŠØ§Ù„</p></div>
<div class="card available-card"><h3>Ø§Ù„Ø±ØµÙŠØ¯ Ø§Ù„Ù…ØªØ§Ø­ Ø¨Ø¹Ø¯ Ø§Ù„Ø§Ø¯Ø®Ø§Ø±</h3><p>0 Ø±ÙŠØ§Ù„</p></div>
</div>
<div class="chart">
<h3>Ø§Ù„Ø±Ø³Ù… Ø§Ù„Ø¨ÙŠØ§Ù†ÙŠ Ù„Ù„Ø¥ÙŠØ±Ø§Ø¯Ø§Øª</h3>
<canvas id="dashboardChart"></canvas>
</div>
</section>

<section id="income" class="section">
<h1>Ø§Ù„Ø¯Ø®Ù„</h1>
<div class="form-group">
<select id="incomeSelect"></select>
<input type="number" id="incomeAmount" placeholder="Ø§Ù„Ù…Ø¨Ù„Øº">
<button id="addIncome">Ø¥Ø¶Ø§ÙØ© Ø¯Ø®Ù„</button>
<button id="addIncomeItem">Ø¥Ø¶Ø§ÙØ© Ø¨Ù†Ø¯ Ø¬Ø¯ÙŠØ¯</button>
<button id="clearIncomeAmount">Ø­Ø°Ù Ø§Ù„Ù…Ø¨Ø§Ù„Øº ÙÙ‚Ø·</button>
</div>
<div class="form-group">
<select id="editIncomeSelect"></select>
<button id="editIncomeItem">ØªØ¹Ø¯ÙŠÙ„ Ø¨Ù†Ø¯</button>
<button id="deleteIncomeItem">Ø­Ø°Ù Ø¨Ù†Ø¯</button>
</div>
<ul id="incomeList"></ul>
</section>

<section id="expenses" class="section">
<h1>Ø§Ù„Ù…ØµØ±ÙˆÙØ§Øª</h1>
<div class="form-group">
<select id="expenseSelect"></select>
<input type="number" id="expenseAmount" placeholder="Ø§Ù„Ù…Ø¨Ù„Øº">
<button id="addExpense">Ø¥Ø¶Ø§ÙØ© Ù…ØµØ±ÙˆÙ</button>
<button id="addExpenseItem">Ø¥Ø¶Ø§ÙØ© Ø¨Ù†Ø¯ Ø¬Ø¯ÙŠØ¯</button>
<button id="clearExpenseAmount">Ø­Ø°Ù Ø§Ù„Ù…Ø¨Ø§Ù„Øº ÙÙ‚Ø·</button>
</div>
<div class="form-group">
<select id="editExpenseSelect"></select>
<button id="editExpenseItem">ØªØ¹Ø¯ÙŠÙ„ Ø¨Ù†Ø¯</button>
<button id="deleteExpenseItem">Ø­Ø°Ù Ø¨Ù†Ø¯</button>
</div>
<ul id="expenseList"></ul>
</section>

<section id="liabilities" class="section">
<h1>Ø§Ù„Ø§Ù„ØªØ²Ø§Ù…Ø§Øª</h1>
<div class="form-group">
<input type="text" id="liabilityTitle" placeholder="Ø§Ù„Ø¨Ù†Ø¯">
<input type="number" id="liabilityAmount" placeholder="Ø§Ù„Ù…Ø¨Ù„Øº">
<input type="date" id="liabilityDate">
<select id="liabilityStatus">
<option value="ØºÙŠØ± Ù…Ø¯ÙÙˆØ¹">ØºÙŠØ± Ù…Ø¯ÙÙˆØ¹</option>
<option value="Ù…Ø¯ÙÙˆØ¹">Ù…Ø¯ÙÙˆØ¹</option>
</select>
<button id="addLiability">Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø§Ù„ØªØ²Ø§Ù…</button>
</div>
<div class="chart">
<table id="liabilitiesTable">
<thead><tr><th>Ø§Ù„Ø¨Ù†Ø¯</th><th>Ø§Ù„Ù…Ø¨Ù„Øº</th><th>Ø§Ù„ØªØ§Ø±ÙŠØ®</th><th>Ø§Ù„Ø­Ø§Ù„Ø©</th><th>Ø­Ø°Ù</th><th>ØªØºÙŠÙŠØ± Ø§Ù„Ø­Ø§Ù„Ø©</th></tr></thead>
<tbody></tbody>
</table>
</div>
</section>

<section id="months" class="section">
<h1>Ø§Ù„Ø£Ø´Ù‡Ø±</h1>
<select id="monthSelect">
<option value="0">ÙŠÙ†Ø§ÙŠØ±</option><option value="1">ÙØ¨Ø±Ø§ÙŠØ±</option><option value="2">Ù…Ø§Ø±Ø³</option>
<option value="3">Ø£Ø¨Ø±ÙŠÙ„</option><option value="4">Ù…Ø§ÙŠÙˆ</option><option value="5">ÙŠÙˆÙ†ÙŠÙˆ</option>
<option value="6">ÙŠÙˆÙ„ÙŠÙˆ</option><option value="7">Ø£ØºØ³Ø·Ø³</option>
<option value="8">Ø³Ø¨ØªÙ…Ø¨Ø±</option><option value="9">Ø£ÙƒØªÙˆØ¨Ø±</option>
<option value="10">Ù†ÙˆÙÙ…Ø¨Ø±</option><option value="11">Ø¯ÙŠØ³Ù…Ø¨Ø±</option>
</select>
<p>ØªØºÙŠÙŠØ± Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø­Ø³Ø¨ Ø§Ù„Ø´Ù‡Ø± Ø§Ù„Ù…Ø­Ø¯Ø¯</p>
</section>

<!-- Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ± -->
<section id="reports" class="section">
<h1>Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ±</h1>
<div id="reportSummary" class="chart">
<p>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø¯Ø®Ù„: <span id="reportIncome">0</span></p>
<p>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…ØµØ±ÙˆÙ: <span id="reportExpenses">0</span></p>
<p>ØµØ§ÙÙŠ Ø§Ù„Ø±ØµÙŠØ¯: <span id="reportBalance">0</span></p>
<p>Ø§Ù„Ø§Ø¯Ø®Ø§Ø±: <span id="reportSaving">0</span></p>
<p>Ø§Ù„Ø±ØµÙŠØ¯ Ø§Ù„Ù…ØªØ§Ø­ Ø¨Ø¹Ø¯ Ø§Ù„Ø§Ø¯Ø®Ø§Ø±: <span id="reportAvailable">0</span></p>
</div>
<div class="chart">
<canvas id="reportChart"></canvas>
</div>
<button id="printButton">Ø·Ø¨Ø§Ø¹Ø© Ø§Ù„ØªÙ‚Ø±ÙŠØ±</button>
</section>	

<section id="settings" class="section">
<h1>Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª</h1>
<div class="form-group">
<button id="resetData">Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ† Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</button>
<select id="currencySelect">
<option value="Ø±ÙŠØ§Ù„">Ø±ÙŠØ§Ù„</option>
<option value="Ø¯ÙˆÙ„Ø§Ø±">Ø¯ÙˆÙ„Ø§Ø±</option>
<option value="ÙŠÙˆØ±Ùˆ">ÙŠÙˆØ±Ùˆ</option>
</select>
<input type="number" id="savingPercent" placeholder="Ù†Ø³Ø¨Ø© Ø§Ù„Ø§Ø¯Ø®Ø§Ø±" value="20">
</div>
</section>

</main>
</div>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
// ===== JS ÙƒØ§Ù…Ù„ Ù…Ø¹ Ø§Ù„ÙˆØ¸Ø§Ø¦Ù =====

// Ø§Ù„ØªÙ†Ù‚Ù„ Ø¨ÙŠÙ† Ø§Ù„Ø£Ù‚Ø³Ø§Ù…
const sections=document.querySelectorAll('.section');
const sidebarItems=document.querySelectorAll('.sidebar ul li');
sidebarItems.forEach(item=>item.addEventListener('click',()=>{
  sidebarItems.forEach(i=>i.classList.remove('active'));
  sections.forEach(s=>s.classList.remove('active'));
  item.classList.add('active');
  document.getElementById(item.dataset.section).classList.add('active');
}));

// ØªØ®Ø²ÙŠÙ† Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
let monthlyIncome=JSON.parse(localStorage.getItem('monthlyIncome'))||Array(12).fill().map(()=>[]);
let monthlyExpenses=JSON.parse(localStorage.getItem('monthlyExpenses'))||Array(12).fill().map(()=>[]);
let monthlyLiabilities=JSON.parse(localStorage.getItem('monthlyLiabilities'))||Array(12).fill().map(()=>[]);
let currentMonth=parseInt(localStorage.getItem('currentMonth'))||0;
let currentCurrency = localStorage.getItem('currentCurrency') || 'Ø±ÙŠØ§Ù„';

const incomeList=document.getElementById('incomeList');
const expenseList=document.getElementById('expenseList');
const liabilitiesTable=document.querySelector('#liabilitiesTable tbody');
const incomeTotal=document.querySelector('.income-card p');
const expensesTotal=document.querySelector('.expenses-card p');
const balanceTotal=document.querySelector('.balance-card p');
const savingsTotal=document.querySelector('.savings-card p');
const availableTotal=document.querySelector('.available-card p');

const incomeSelect=document.getElementById('incomeSelect');
const expenseSelect=document.getElementById('expenseSelect');
const monthSelect=document.getElementById('monthSelect');

const defaultIncome=['Ø±Ø§ØªØ¨','Ù…Ø´Ø±ÙˆØ¹','Ø§Ø³ØªØ«Ù…Ø§Ø±'];
const defaultExpense=['Ø³ÙƒÙ†','Ø·Ø¹Ø§Ù…','ØªÙ†Ù‚Ù„'];

// ØªÙ‡ÙŠØ¦Ø© select
function initSelectOptions(){
  if(incomeSelect.options.length===0) defaultIncome.forEach(item=>{
    const option=document.createElement('option'); option.value=item; option.textContent=item; incomeSelect.appendChild(option);
  });
  if(expenseSelect.options.length===0) defaultExpense.forEach(item=>{
    const option=document.createElement('option'); option.value=item; option.textContent=item; expenseSelect.appendChild(option);
  });
}
initSelectOptions();

// ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù‚ÙˆØ§Ø¦Ù…
function updateIncomeEditSelect(){
  const select=document.getElementById('editIncomeSelect'); select.innerHTML='';
  monthlyIncome[currentMonth].forEach(i=>{ const option=document.createElement('option'); option.value=i.title; option.textContent=i.title; select.appendChild(option); });
}
function updateExpenseEditSelect(){
  const select=document.getElementById('editExpenseSelect'); select.innerHTML='';
  monthlyExpenses[currentMonth].forEach(i=>{ const option=document.createElement('option'); option.value=i.title; option.textContent=i.title; select.appendChild(option); });
}

// Ø§Ù„Ø±Ø³ÙˆÙ… Ø§Ù„Ø¨ÙŠØ§Ù†ÙŠØ©
const ctx=document.getElementById('dashboardChart').getContext('2d');
const dashboardChart=new Chart(ctx,{type:'bar',data:{labels:['ÙŠÙ†Ø§ÙŠØ±','ÙØ¨Ø±Ø§ÙŠØ±','Ù…Ø§Ø±Ø³','Ø£Ø¨Ø±ÙŠÙ„','Ù…Ø§ÙŠÙˆ','ÙŠÙˆÙ†ÙŠÙˆ','ÙŠÙˆÙ„ÙŠÙˆ','Ø£ØºØ³Ø·Ø³','Ø³Ø¨ØªÙ…Ø¨Ø±','Ø£ÙƒØªÙˆØ¨Ø±','Ù†ÙˆÙÙ…Ø¨Ø±','Ø¯ÙŠØ³Ù…Ø¨Ø±'],datasets:[{label:'Ø§Ù„Ø¯Ø®Ù„',data:Array(12).fill(0),backgroundColor:'rgba(46,125,50,0.7)',borderRadius:5},{label:'Ø§Ù„Ù…ØµØ±ÙˆÙØ§Øª',data:Array(12).fill(0),backgroundColor:'rgba(198,40,40,0.7)',borderRadius:5}]},options:{responsive:true,plugins:{legend:{labels:{color:'#000'}},tooltip:{enabled:true,backgroundColor:'#fff',titleColor:'#000',bodyColor:'#000'}},scales:{x:{ticks:{color:'#000'},grid:{color:'rgba(0,0,0,0.05)'}},y:{ticks:{color:'#000'},grid:{color:'rgba(0,0,0,0.05)'},beginAtZero:true}}}});
const reportCtx=document.getElementById('reportChart').getContext('2d');
const reportChart=new Chart(reportCtx,{type:'bar',data:{labels:['ÙŠÙ†Ø§ÙŠØ±','ÙØ¨Ø±Ø§ÙŠØ±','Ù…Ø§Ø±Ø³','Ø£Ø¨Ø±ÙŠÙ„','Ù…Ø§ÙŠÙˆ','ÙŠÙˆÙ†ÙŠÙˆ','ÙŠÙˆÙ„ÙŠÙˆ','Ø£ØºØ³Ø·Ø³','Ø³Ø¨ØªÙ…Ø¨Ø±','Ø£ÙƒØªÙˆØ¨Ø±','Ù†ÙˆÙÙ…Ø¨Ø±','Ø¯ÙŠØ³Ù…Ø¨Ø±'],datasets:[{label:'Ø§Ù„Ø¯Ø®Ù„',data:Array(12).fill(0),backgroundColor:'rgba(46,125,50,0.7)',borderRadius:5},{label:'Ø§Ù„Ù…ØµØ±ÙˆÙØ§Øª',data:Array(12).fill(0),backgroundColor:'rgba(198,40,40,0.7)',borderRadius:5}]},options:{responsive:true,plugins:{legend:{labels:{color:'#000'}},tooltip:{enabled:true,backgroundColor:'#fff',titleColor:'#000',bodyColor:'#000'}},scales:{x:{ticks:{color:'#000'},grid:{color:'rgba(0,0,0,0.05)'}},y:{ticks:{color:'#000'},grid:{color:'rgba(0,0,0,0.05)'},beginAtZero:true}}}});

// ===== ØªØ­Ø¯ÙŠØ« Dashboard =====
function updateDashboard(){
  const totalIncome=monthlyIncome[currentMonth].reduce((sum,i)=>sum+(i.amount||0),0);
  const totalExpenses=monthlyExpenses[currentMonth].reduce((sum,i)=>sum+(i.amount||0),0)+monthlyLiabilities[currentMonth].filter(l=>l.status==='Ù…Ø¯ÙÙˆØ¹').reduce((sum,l)=>sum+l.amount,0);
  const savingPercent=parseFloat(document.getElementById('savingPercent')?.value)||20;
  const saving=Math.round((totalIncome-totalExpenses)*(savingPercent/100));
  const available=totalIncome-totalExpenses-saving;

  incomeTotal.textContent=totalIncome+" "+currentCurrency;
  expensesTotal.textContent=totalExpenses+" "+currentCurrency;
  balanceTotal.textContent=(totalIncome-totalExpenses)+" "+currentCurrency;
  savingsTotal.textContent=saving+" "+currentCurrency;
  availableTotal.textContent=available+" "+currentCurrency;

  dashboardChart.data.datasets[0].data=monthlyIncome.map(m=>m.reduce((sum,i)=>sum+(i.amount||0),0));
  dashboardChart.data.datasets[1].data=monthlyExpenses.map((m,i)=>m.reduce((sum,j)=>sum+(j.amount||0),0)+monthlyLiabilities[i].filter(l=>l.status==='Ù…Ø¯ÙÙˆØ¹').reduce((sum,l)=>sum+l.amount,0));
  dashboardChart.update();

  document.getElementById('reportIncome').textContent=totalIncome+" "+currentCurrency;
  document.getElementById('reportExpenses').textContent=totalExpenses+" "+currentCurrency;
  document.getElementById('reportBalance').textContent=(totalIncome-totalExpenses)+" "+currentCurrency;
  document.getElementById('reportSaving').textContent=saving+" "+currentCurrency;
  document.getElementById('reportAvailable').textContent=available+" "+currentCurrency;

  reportChart.data.datasets[0].data=monthlyIncome.map(m=>m.reduce((sum,i)=>sum+(i.amount||0),0));
  reportChart.data.datasets[1].data=monthlyExpenses.map((m,i)=>m.reduce((sum,j)=>sum+(j.amount||0),0)+monthlyLiabilities[i].filter(l=>l.status==='Ù…Ø¯ÙÙˆØ¹').reduce((sum,l)=>sum+l.amount,0));
  reportChart.update();

  localStorage.setItem('monthlyIncome',JSON.stringify(monthlyIncome));
  localStorage.setItem('monthlyExpenses',JSON.stringify(monthlyExpenses));
  localStorage.setItem('monthlyLiabilities',JSON.stringify(monthlyLiabilities));
  localStorage.setItem('currentMonth',currentMonth);
  localStorage.setItem('currentCurrency',currentCurrency);

  renderIncomeList();
  renderExpenseList();
  renderLiabilitiesList();
  updateIncomeEditSelect();
  updateExpenseEditSelect();
}

// ===== Render Ø§Ù„Ù‚ÙˆØ§Ø¦Ù… =====
function renderIncomeList(){
  incomeList.innerHTML='';
  monthlyIncome[currentMonth].forEach(item=>{
    const li=document.createElement('li');
    li.textContent=`${item.title} - ${item.amount||0} ${currentCurrency}`;
    incomeList.appendChild(li);
  });
}
function renderExpenseList(){
  expenseList.innerHTML='';
  monthlyExpenses[currentMonth].forEach(item=>{
    const li=document.createElement('li');
    li.textContent=`${item.title} - ${item.amount||0} ${currentCurrency}`;
    expenseList.appendChild(li);
  });
}
function renderLiabilitiesList(){
  liabilitiesTable.innerHTML='';
  monthlyLiabilities[currentMonth].forEach((item,index)=>{
    const tr=document.createElement('tr');
    tr.innerHTML=`<td>${item.title}</td><td>${item.amount}</td><td>${item.date}</td><td>${item.status}</td>
    <td><button onclick="deleteLiability(${index})">Ø­Ø°Ù</button></td>
    <td><button onclick="toggleLiabilityStatus(${index})">ØªØºÙŠÙŠØ± Ø§Ù„Ø­Ø§Ù„Ø©</button></td>`;
    liabilitiesTable.appendChild(tr);
  });
}

// ===== Ø§Ù„Ø§Ù„ØªØ²Ø§Ù…Ø§Øª =====
function deleteLiability(idx){ if(confirm('Ù‡Ù„ ØªØ±ÙŠØ¯ Ø­Ø°Ù Ù‡Ø°Ø§ Ø§Ù„Ø§Ù„ØªØ²Ø§Ù…ØŸ')){ monthlyLiabilities[currentMonth].splice(idx,1); updateDashboard(); } }
function toggleLiabilityStatus(idx){ const item=monthlyLiabilities[currentMonth][idx]; item.status=item.status==='Ù…Ø¯ÙÙˆØ¹'?'ØºÙŠØ± Ù…Ø¯ÙÙˆØ¹':'Ù…Ø¯ÙÙˆØ¹'; updateDashboard(); }

// ===== Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø¯Ø®Ù„ ÙˆØ§Ù„Ù…ØµØ±ÙˆÙ =====
document.getElementById('addIncome').addEventListener('click',()=>{
  const val=parseFloat(document.getElementById('incomeAmount').value);
  if(isNaN(val)) return alert('ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ù…Ø¨Ù„Øº ØµØ­ÙŠØ­');
  const title=incomeSelect.value;
  const existing=monthlyIncome[currentMonth].find(i=>i.title===title);
  if(existing){ existing.amount=(existing.amount||0)+val; } else monthlyIncome[currentMonth].push({title,amount:val});
  document.getElementById('incomeAmount').value=''; updateDashboard();
});
document.getElementById('addExpense').addEventListener('click',()=>{
  const val=parseFloat(document.getElementById('expenseAmount').value);
  if(isNaN(val)) return alert('ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ù…Ø¨Ù„Øº ØµØ­ÙŠØ­');
  const title=expenseSelect.value;
  const existing=monthlyExpenses[currentMonth].find(i=>i.title===title);
  if(existing){ existing.amount=(existing.amount||0)+val; } else monthlyExpenses[currentMonth].push({title,amount:val});
  document.getElementById('expenseAmount').value=''; updateDashboard();
});

// Ø§Ù„Ø¨Ù†ÙˆØ¯ Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©
document.getElementById('addIncomeItem').addEventListener('click',()=>{
  const title=prompt('Ø£Ø¯Ø®Ù„ Ø§Ø³Ù… Ø§Ù„Ø¨Ù†Ø¯ Ø§Ù„Ø¬Ø¯ÙŠØ¯ Ù„Ù„Ø¯Ø®Ù„:');
  if(title && !monthlyIncome[currentMonth].some(i=>i.title===title)){
    monthlyIncome[currentMonth].push({title,amount:0});
    const option=document.createElement('option'); option.value=title; option.textContent=title; incomeSelect.appendChild(option); updateDashboard();
  }
});
document.getElementById('addExpenseItem').addEventListener('click',()=>{
  const title=prompt('Ø£Ø¯Ø®Ù„ Ø§Ø³Ù… Ø§Ù„Ø¨Ù†Ø¯ Ø§Ù„Ø¬Ø¯ÙŠØ¯ Ù„Ù„Ù…ØµØ±ÙˆÙØ§Øª:');
  if(title && !monthlyExpenses[currentMonth].some(i=>i.title===title)){
    monthlyExpenses[currentMonth].push({title,amount:0});
    const option=document.createElement('option'); option.value=title; option.textContent=title; expenseSelect.appendChild(option); updateDashboard();
  }
});

// ØªØ¹Ø¯ÙŠÙ„ ÙˆØ­Ø°Ù Ø§Ù„Ø¨Ù†ÙˆØ¯
document.getElementById('editIncomeItem').addEventListener('click',()=>{
  const select=document.getElementById('editIncomeSelect'); const title=select.value;
  const item=monthlyIncome[currentMonth].find(i=>i.title===title);
  if(item){ const newTitle=prompt('Ø£Ø¯Ø®Ù„ Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ø¬Ø¯ÙŠØ¯ Ù„Ù„Ø¨Ù†Ø¯:',item.title); if(newTitle){ item.title=newTitle; updateDashboard(); updateIncomeEditSelect(); } } else alert('Ø§Ù„Ø¨Ù†Ø¯ ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯');
});
document.getElementById('deleteIncomeItem').addEventListener('click',()=>{
  const select=document.getElementById('editIncomeSelect'); const title=select.value;
  const idx=monthlyIncome[currentMonth].findIndex(i=>i.title===title);
  if(idx>=0){ if(confirm('âš ï¸ Ø³ÙŠØªÙ… Ø­Ø°Ù Ù‡Ø°Ø§ Ø§Ù„Ø¨Ù†Ø¯ Ù†Ù‡Ø§Ø¦ÙŠØ§Ù‹. Ù‡Ù„ ØªØ±ÙŠØ¯ Ø§Ù„Ù…ØªØ§Ø¨Ø¹Ø©ØŸ')){ monthlyIncome[currentMonth].splice(idx,1); updateDashboard(); updateIncomeEditSelect(); } } else alert('Ø§Ù„Ø¨Ù†Ø¯ ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯');
});
document.getElementById('editExpenseItem').addEventListener('click',()=>{
  const select=document.getElementById('editExpenseSelect'); const title=select.value;
  const item=monthlyExpenses[currentMonth].find(i=>i.title===title);
  if(item){ const newTitle=prompt('Ø£Ø¯Ø®Ù„ Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ø¬Ø¯ÙŠØ¯ Ù„Ù„Ø¨Ù†Ø¯:',item.title); if(newTitle){ item.title=newTitle; updateDashboard(); updateExpenseEditSelect(); } } else alert('Ø§Ù„Ø¨Ù†Ø¯ ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯');
});
document.getElementById('deleteExpenseItem').addEventListener('click',()=>{
  const select=document.getElementById('editExpenseSelect'); const title=select.value;
  const idx=monthlyExpenses[currentMonth].findIndex(i=>i.title===title);
  if(idx>=0){ if(confirm('âš ï¸ Ø³ÙŠØªÙ… Ø­Ø°Ù Ù‡Ø°Ø§ Ø§Ù„Ø¨Ù†Ø¯ Ù†Ù‡Ø§Ø¦ÙŠØ§Ù‹. Ù‡Ù„ ØªØ±ÙŠØ¯ Ø§Ù„Ù…ØªØ§Ø¨Ø¹Ø©ØŸ')){ monthlyExpenses[currentMonth].splice(idx,1); updateDashboard(); updateExpenseEditSelect(); } } else alert('Ø§Ù„Ø¨Ù†Ø¯ ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯');
});

// Ø­Ø°Ù Ø§Ù„Ù…Ø¨Ø§Ù„Øº ÙÙ‚Ø·
document.getElementById('clearIncomeAmount').addEventListener('click',()=>{ monthlyIncome[currentMonth]=monthlyIncome[currentMonth].map(i=>{ i.amount=0; return i; }); updateDashboard(); });
document.getElementById('clearExpenseAmount').addEventListener('click',()=>{ monthlyExpenses[currentMonth]=monthlyExpenses[currentMonth].map(i=>{ i.amount=0; return i; }); updateDashboard(); });

// Ø§Ù„Ø§Ù„ØªØ²Ø§Ù…Ø§Øª
document.getElementById('addLiability').addEventListener('click',()=>{
  const title=document.getElementById('liabilityTitle').value.trim();
  const amount=parseFloat(document.getElementById('liabilityAmount').value);
  const date=document.getElementById('liabilityDate').value;
  const status=document.getElementById('liabilityStatus').value;
  if(!title||isNaN(amount)||!date) return alert('ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙƒØ§Ù…Ù„Ø©');
  const duplicate=monthlyLiabilities[currentMonth].some(l=>l.title===title && l.amount===amount && l.date===date && l.status===status);
  if(duplicate) return alert('Ù‡Ø°Ø§ Ø§Ù„Ø§Ù„ØªØ²Ø§Ù… Ù…ÙˆØ¬ÙˆØ¯ Ù…Ø³Ø¨Ù‚Ù‹Ø§');
  monthlyLiabilities[currentMonth].push({title,amount,date,status});
  document.getElementById('liabilityTitle').value=''; document.getElementById('liabilityAmount').value=''; document.getElementById('liabilityDate').value='';
  updateDashboard();
});

// Ø§Ù„Ø£Ø´Ù‡Ø±
monthSelect.addEventListener('change',()=>{ currentMonth=parseInt(monthSelect.value); updateDashboard(); });

// Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª
document.getElementById('savingPercent').addEventListener('change',updateDashboard);
document.getElementById('currencySelect').addEventListener('change',e=>{ currentCurrency=e.target.value; updateDashboard(); });
document.getElementById('resetData').addEventListener('click',()=>{
  if(confirm('âš ï¸ Ø³ÙŠØªÙ… Ù…Ø³Ø­ Ø¬Ù…ÙŠØ¹ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù†Ù‡Ø§Ø¦ÙŠØ§Ù‹. Ù‡Ù„ ØªØ±ÙŠØ¯ Ø§Ù„Ù…ØªØ§Ø¨Ø¹Ø©ØŸ')){
    monthlyIncome=Array(12).fill().map(()=>[]); monthlyExpenses=Array(12).fill().map(()=>[]); monthlyLiabilities=Array(12).fill().map(()=>[]); updateDashboard();
  }
});

// Ø·Ø¨Ø§Ø¹Ø© Ø§Ù„ØªÙ‚Ø±ÙŠØ±
document.getElementById('printButton').addEventListener('click',()=>{
  const reportContent = `
  <h1 style="text-align:center; margin-bottom:20px;">ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ù…ÙŠØ²Ø§Ù†ÙŠØ© Ø§Ù„Ø´Ù‡Ø±ÙŠØ©</h1>
  <p>Ø§Ù„Ø´Ù‡Ø±: ${document.getElementById('monthSelect').selectedOptions[0].text}</p>
  <p>Ø§Ù„Ø¹Ù…Ù„Ø©: ${currentCurrency}</p>
  <hr>
  <h2>Ù…Ù„Ø®Øµ Ù…Ø§Ù„ÙŠ</h2>
  <table>
    <tr><th>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø¯Ø®Ù„</th><td>${document.getElementById('reportIncome').textContent}</td></tr>
    <tr><th>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…ØµØ±ÙˆÙØ§Øª</th><td>${document.getElementById('reportExpenses').textContent}</td></tr>
    <tr><th>ØµØ§ÙÙŠ Ø§Ù„Ø±ØµÙŠØ¯</th><td>${document.getElementById('reportBalance').textContent}</td></tr>
    <tr><th>Ø§Ù„Ø§Ø¯Ø®Ø§Ø±</th><td>${document.getElementById('reportSaving').textContent}</td></tr>
    <tr><th>Ø§Ù„Ø±ØµÙŠØ¯ Ø§Ù„Ù…ØªØ§Ø­ Ø¨Ø¹Ø¯ Ø§Ù„Ø§Ø¯Ø®Ø§Ø±</th><td>${document.getElementById('reportAvailable').textContent}</td></tr>
  </table>
  <hr>
  <h2>Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø¯Ø®Ù„</h2>
  <table>
    <tr><th>Ø§Ù„Ø¨Ù†Ø¯</th><th>Ø§Ù„Ù…Ø¨Ù„Øº</th></tr>
    ${monthlyIncome[currentMonth].map(i=>`<tr><td>${i.title}</td><td>${i.amount} ${currentCurrency}</td></tr>`).join('')}
  </table>
  <h2>Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…ØµØ±ÙˆÙØ§Øª</h2>
  <table>
    <tr><th>Ø§Ù„Ø¨Ù†Ø¯</th><th>Ø§Ù„Ù…Ø¨Ù„Øº</th></tr>
    ${monthlyExpenses[currentMonth].map(i=>`<tr><td>${i.title}</td><td>${i.amount} ${currentCurrency}</td></tr>`).join('')}
  </table>
  <h2>Ø§Ù„Ø§Ù„ØªØ²Ø§Ù…Ø§Øª</h2>
  <table>
    <tr><th>Ø§Ù„Ø¨Ù†Ø¯</th><th>Ø§Ù„Ù…Ø¨Ù„Øº</th><th>Ø§Ù„ØªØ§Ø±ÙŠØ®</th><th>Ø§Ù„Ø­Ø§Ù„Ø©</th></tr>
    ${monthlyLiabilities[currentMonth].map(l=>`<tr><td>${l.title}</td><td>${l.amount} ${currentCurrency}</td><td>${l.date}</td><td>${l.status}</td></tr>`).join('')}
  </table>
  `;
  const printWindow=window.open('','', 'width=1000,height=800');
  printWindow.document.write(`<html><head><title>Ù…Ø¹Ø§ÙŠÙ†Ø© Ø§Ù„Ø·Ø¨Ø§Ø¹Ø©</title>
  <style>
    body{font-family:'Cairo','Tajawal',sans-serif;direction:rtl;background:#fff;color:#000;padding:20px;}
    h1,h2{text-align:center;} table{width:100%;border-collapse:collapse;margin-bottom:20px;} th,td{border:1px solid #000;padding:10px;text-align:center;} th{background:#f2f2f2;} hr{margin:20px 0;border:none;border-top:2px solid #000;} @media print{button{display:none;}}
  </style></head><body>${reportContent}<button onclick="window.print()">Ø·Ø¨Ø§Ø¹Ø©</button></body></html>`);
  printWindow.document.close();
});

updateDashboard();
</script>
</body>
</html>
